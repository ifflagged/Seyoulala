#!name = ğŸ¿ï¸ DualSubs: â–¶ï¸ YouTube
#!desc = YouTube å¢å¼ºåŠåŒè¯­å­—å¹•(æ­Œè¯)
#!openUrl = http://boxjs.com/#/app/DualSubs.YouTube
#!author = VirgilClyne[https://github.com/VirgilClyne]
#!homepage = https://DualSubs.github.io/guide/youtube
#!icon = https://github.com/DualSubs/YouTube/raw/main/src/assets/icon_rounded.png
#!tag = ğŸ¿ï¸ DualSubs
#!system = iOS,iPadOS,macOS
#!date = 2024-11-30 18:24:17
#!version = 1.5.8
#!system_version = 15

[Argument]
Type = select,"Official","Translate",tag=[å­—å¹•] å¯ç”¨ç±»å‹,desc=è¯·é€‰æ‹©è¦ä½¿ç”¨çš„å­—å¹•ï¼ŒåŒè¯­å­—å¹•å°†ä½¿ç”¨æ‚¨é€‰æ‹©ç±»å‹å‘ˆç°ã€‚
Types = input,"Translate",tag=[æ­Œè¯] å¯ç”¨ç±»å‹,desc=è¯·é€‰æ‹©è¦æ·»åŠ çš„æ­Œè¯é€‰é¡¹ï¼Œå¦‚æœä¸ºå¤šé€‰ï¼Œåˆ™ä¼šè‡ªåŠ¨å†³å®šæä¾›çš„æ­Œè¯ç±»å‹ã€‚
AutoCC = switch,true,tag=[å­—å¹•] è‡ªåŠ¨æ˜¾ç¤º,desc=æ˜¯å¦æ€»æ˜¯è‡ªåŠ¨å¼€å¯å­—å¹•æ˜¾ç¤ºã€‚
Position = select,"Forward","Reverse",tag=[å­—å¹•] ä¸»è¯­è¨€ï¼ˆæºè¯­è¨€ï¼‰å­—å¹•ä½ç½®,desc=ä¸»è¯­è¨€ï¼ˆæºè¯­è¨€ï¼‰å­—å¹•çš„æ˜¾ç¤ºä½ç½®ã€‚
Languages[0] = select,"AUTO","ZH","ZH-HANS","ZH-HK","ZH-HANT","EN","ES","JA","KO","DE","FR","TR","KM",tag=[ç¿»è¯‘å™¨] ä¸»è¯­è¨€ï¼ˆæºè¯­è¨€ï¼‰,desc=ä»…å½“æºè¯­è¨€è¯†åˆ«ä¸å‡†ç¡®æ—¶æ›´æ”¹æ­¤é€‰é¡¹ã€‚
Languages[1] = select,"ZH","ZH-HANS","ZH-HK","ZH-HANT","EN","EN-US","ES","ES-ES","ES-419","JA","KO","DE","FR","TR","KM",tag=[ç¿»è¯‘å™¨] å‰¯è¯­è¨€ï¼ˆç›®æ ‡è¯­è¨€ï¼‰,desc=è¯·æŒ‡å®šç¿»è¯‘æ­Œè¯çš„ç›®æ ‡è¯­è¨€ã€‚
Vendor = select,"Google","Microsoft",tag=[ç¿»è¯‘å™¨] æœåŠ¡å•†API,desc=è¯·é€‰æ‹©ç¿»è¯‘å™¨æ‰€ä½¿ç”¨çš„æœåŠ¡å•†APIï¼Œæ›´å¤šç¿»è¯‘é€‰é¡¹è¯·ä½¿ç”¨BoxJsã€‚
ShowOnly = switch,false,tag=[ç¿»è¯‘å™¨] åªæ˜¾ç¤ºâ€œè‡ªåŠ¨ç¿»è¯‘â€å­—å¹•,desc=æ˜¯å¦ä»…æ˜¾ç¤ºâ€œè‡ªåŠ¨ç¿»è¯‘â€åçš„å­—å¹•ï¼Œä¸æ˜¾ç¤ºæºè¯­è¨€å­—å¹•ã€‚

[Rewrite]
# ä½¿ç”¨reject-imgå‡å°‘å¼€é”€
^https?:\/\/([\w-]+)\.googlevideo\.com\/initplayback(\?.*oad=.+)$ reject-img

[Script]
# YouTube
http-request ^https?:\/\/(www|m|tv)\.youtube\.com\/youtubei\/v1\/player(\?.+)?$ requires-body=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/request.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Player.request.json, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/(www|m|tv)\.youtube\.com\/youtubei\/v1\/player(\?.+)?$ requires-body=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Player.response.json, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-request ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/player(\?.+)?$ requires-body=1, binary-body-mode=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/request.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Player.request.proto, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/player(\?.+)?$ requires-body=1, binary-body-mode=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Player.response.proto, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/get_watch(\?.+)?$ requires-body=1, binary-body-mode=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.GetWatch.response.proto, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-request ^https?:\/\/(www|m)\.youtube\.com\/api\/timedtext(\?.+)?$ script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/request.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.TimedText.request, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/(www|m)\.youtube\.com\/api\/timedtext\?(.*)subtype=(Official|External) requires-body=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/Composite.Subtitles.response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Composite.TimedText.response, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/(www|m)\.youtube\.com\/api\/timedtext\?(.*)subtype=Translate requires-body=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/Translate.response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Translate.TimedText.response, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]

# YouTube Music
http-request ^https?:\/\/music\.youtube\.com\/youtubei\/v1\/browse(\?.+)?$ requires-body=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/request.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTubeMusic.Browse.request.json, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-request ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/browse(\?.+)?$ requires-body=1, binary-body-mode=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/request.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTube.Browse.request.proto, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/music\.youtube\.com\/youtubei\/v1\/browse\?(.*)subtype=Translate requires-body=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/Translate.response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTubeMusic.Translate.Lyrics.response.json, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]
http-response ^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/browse\?(.*)subtype=Translate requires-body=1, binary-body-mode=1, script-path=https://github.com/ifflagged/Darwin/raw/main/Modules/JS/DualSubs/DualSubs.YouTube/Translate.response.bundle.js, tag=ğŸ¿ï¸ DualSubs.YouTubeMusic.Translate.Lyrics.response.proto, argument=[{Type},{Types},{AutoCC},{Position},{Languages[0]},{Languages[1]},{Vendor},{ShowOnly}]

[MITM]
hostname = www.youtube.com, m.youtube.com, tv.youtube.com, music.youtube.com, youtubei.googleapis.com, -redirector*.googlevideo.com, *.googlevideo.com
