#!name=ğŸµ TikTok
#!desc=TikTok Unlock
#!icon=https://raw.githubusercontent.com/luestr/IconResource/main/App_icon/120px/Loon.png
#!tag=Jacob

#!arguments-desc=TikTok_Region: è§£é” TikTok åœ°åŒºçš„åœ°åŒºç \nç¾å›½ï¼šUS, å°æ¹¾ï¼šTW, æ–°åŠ å¡ï¼šSG, æ—¥æœ¬ï¼šJP, éŸ©å›½ï¼šKR\n\nTikTok_Watermark: è„šæœ¬åç§°\n# TikTok Watermark ä¸ºç¦ç”¨
#!auther=https://github.com/githubdulong/Script/raw/master/Surge/TikTok_Surge.sgmodule

[Argument]
TikTok_Region=input,TW,tag=TikTok_Region, desc=TikTok_Region
TikTok_Watermark=input,TikTok Watermark Removal,tag=TikTok_Watermark, desc=TikTok_Watermark

[Rewrite]
(?<=_region=)CN(?=&) {TikTok_Region} 307
(?<=&mcc_mnc=)4 2 307
^(https?:\/\/(tnc|dm)[\w-]+\.\w+\.com\/.+)(\?)(.+) $1$3 302
(^https?:\/\/*\.\w{4}okv.com\/.+&.+)(\d{2}\.3\.\d)(.+) $118.0$3 302
# å»å¹¿å‘Š
^https:\/\/api-va\.tiktokv\.com\/api\/ad\/ - reject
# åŸŸåè§£æ
#^https:\/\/tnc\d+-platform-\w+\.tiktokv\.com\/get_domains\/ - reject

[Script]
# > TikTok å»æ°´å°
http-response https?:\/\/.*\.tiktokv\.com\/aweme\/v\d\/(feed|mix\/aweme|aweme\/post|(multi\/)?aweme\/detail|follow\/feed|nearby\/feed|search\/item|general\/search\/single|hot\/search\/video\/list|aweme\/favorite) script-path=https://github.com/ifflagged/Seyoulala/raw/main/Modules/JS/ifflagged/TikTok/Tiktok.js, requires-body=true, timeout=30, tag={TikTok_Watermark}

[MITM]
hostname = *.tiktokv.com, *.byteoversea.com, *.tik-tokapi.com

